/*

TODO:  we don't highlight details pages...
check filtersapplied and character mapping to I saw someing in financial contributors
--in privsatr funding i get the alpha check in the listing parts as well as the data part.. I think was was an error but verofy
POH search... Name for Sure..
paging on POH and other convert to numberic doesn't work...it pages based on higher number and not SMs
POHName partially working.. but is still incorrect.

POHType multiselect -> not implemented..


pdf generation notice.. needs to be inmplemented...maybe (it does go to another page)


sm16307 -- REGISTRANT IS AN INHOUSE LOBBYIST AND IN COMM IS SENIOR OFFICER

--> lobbyist filter is wrong..woth regards to senior officer and lobbyist F

Still need to keep beneficiary list.. as records are dupicated so they can be alphaticalized

==> can i standardized re-use filter logic per report?

do we need a MAP and have S1, B1, F1 for each segment. so we have a special option to retrieve the map anf then use throughout
-->have return have a special "total" records item.. and with paing: rowNo, Count.
--> need orderBy - basically replicate the agreator stuff.

because I use inpitgroup-adds on  and a fixed width, they don't stack when smaller.
maybe fake from-control-label to look like add-on

Need to do the switch from alpha to number once filtering is on
The reset of the multi-selects is not changeing the text of the dropdown even though it is selected all of them
put in bootstrap validation for type misdmatche4s.. and maybe more.

==> regular search is not included in filtersapplies/reset logic etc.. page numebrs
==> total rows is off a litle bit for paging. chgeck roudning
I lost feedback on regular search.. find it..

Adv Search Validator:
1) if beneficary, then must select Consultant.


Data NOtes:
1) if you have beneficiaries, then there does not seem to be more than one lobyist..>
--> filter out 

Todo: rename JSONData to SMObjs?/


search:  on full name.. how to do it.



If you register a in-house consultant and add a senior office but that officer is not assigned to rhe SM, then he doesn't show up as a
select in the senior office listing. Is this intentional?

A CLient is a beneficary
what is the other beneficairies??? and is the lookup..

search:   use OR for the highlight when adding two space values in bar.. use AND for the folter

put in "X" filter reset... see rob's example (chart pagte)

Fitlerall -- check for unhidden columns and for seach do search automatically.
for filter do filters autoatically.


self invoking mess this up.. check into why?. stuff in global where should be?

on the filter selects.. I could trap the 'All selected' event.. then ignore filter on data. this way any item not of the hard coded values still passes.
*/
function showHideColumns(){var e=rptColumns[selectedReport].Cols
Object.keys(e).forEach(function(t,s,i){e[t]?$("#"+t).show():$("#"+t).hide()})}function writeListingHeaders(){for(var e=rptColumns[selectedReport].Cols,t="<tr id='SubjectMatterListingHdr'>",s=0;s<e.length;s++)t+="<th class='"+e[s]["class"]+"' id='"+e[s].column+"'><label  class='colHdr control-label'>"+e[s].label+"</label> </th>"
t+="</tr>",$("#lobbytable thead").html(t).trigger("update")}function getHighLightFilterOptions(){var e=$("#searchString").val(),t={searchStr:[],searchRegex:[]}
if(e.length>0){var s=e.split(" ")
for(i=0;i<s.length;i++)t.searchStr.push(s[i]),t.searchRegex.push(new RegExp("(.*?)("+s[i]+")(.*)","ig"))}return t.RegNoSearch=$("#regNoSearch").val(),t.LobbyistNameSearch=$("#lobbyistNameSearch").val(),t.LobbyistTypes=decodeMultSelection("#lobbyistTypeFilter"),t.SMStatuses=decodeMultSelection("#statusFilter"),t.SMSearch=$("#subjectMatterFilter").val(),t.ClientSearch=$("#clientSearch").val(),t.BeneficiarySearch=$("#beneficiarySearch").val(),t.GovAgencySearch=$("#govAgencySearch").val(),t.FinancialContributorSearch=$("#financialContributorSearch").val(),t.POHSearch=$("#pohSearch").val(),t.GrassRootsChk=!!$("#grassRootsInd").is(":checked"),t.CommitteeChk=!!$("#committeeInd").is(":checked"),t.DateFrom=moment($("#dateFrom").val()),t.DateTo=moment($("#dateTo").val()),t.POHNameSearch=$("#pohNameSearch").val(),t.POHPositionSearch=$("#pohPositionSearch").val(),t.POHOfficeSearch=$("#pohOfficeSearch").val(),t.POHTypes=decodeMultSelection("#pohTypeFilter"),t.BusOrgNameSearch=$("#busOrgNameSearch").val(),t.startIdx=nextRow,t.endIdx=nextRow+rowsPerPage,t}function highlightSearch(e,t){if(0===t.searchRegex.length)return e
var s=e
for(i=0;i<t.searchRegex.length;i++){var a=s
for(s="";match=t.searchRegex[i].exec(a);)s+=match[1]+'<span class="searchHighlight">'+match[2]+"</span>",a=match[3]
s+=a}return s}function filterSearch(e,t){if(0===t.searchStr.length)return!0
for(var s=!0,i=JSON.stringify(e).toLowerCase(),a=0;a<t.searchStr.length;a++)if(-1===i.indexOf(t.searchStr[a].toLowerCase())){s=!1
break}return s}function loadLobbyists(){if(LobbyistListArray.length>0)return void setAlphaMap(LobbyistListArray,"LastName")
obbyistList={},LobbyistListArray=[]
var e="",t={}
$.each(jsonData,function(s,i){var a=[],r="",o="",n=!1
if(i.SM.Firms&&(a=convertToArrayIfNeccessary(i.SM.Firms.Firm)),$.each(a,function(e,t){return"Parent"!==t.Type&&"Subsidiary"!==t.Type&&"Other"!==t.Type?(r=t.Name,o=t.TradeName,!1):void 0}),i.SM.Communications){var l=[]
l=convertToArrayIfNeccessary(i.SM.Communications.Communication),$.each(l,function(s,a){if((a.LobbyistFirstName||a.LobbyistLastName)&&(a.LobbyistType.length>0&&!t[a.LobbyistType]&&(t[a.LobbyistType]=!0),e=a.LobbyistLastName+", "+a.LobbyistFirstName,lobbyistKey=a.LobbyistLastName+", "+a.LobbyistFirstName+","+r+","+o,e=e.trim(),e.length>0))if(LobbyistList[lobbyistKey]){var l=!1
$.each(LobbyistList[lobbyistKey].SMs,function(e,t){return t.SMNumber===i.SM.SMNumber?(l=!0,!1):void 0}),l||(LobbyistList[lobbyistKey].SMs.push(i.SM),n=!0)}else LobbyistList[lobbyistKey]={LobbyistNumber:a.LobbyistNumber,LobbyistName:a.LobbyistFirstName+" "+a.LobbyistLastName,FirstName:a.LobbyistFirstName,LastName:a.LobbyistLastName,Type:i.SM.Type,Firm:r,FirmTradeName:o,SMs:[]},LobbyistList[lobbyistKey].SMs.push(i.SM),n=!0})}if(i.SM.Registrant){e=i.SM.Registrant.LastName+", "+i.SM.Registrant.FirstName,lobbyistKey=i.SM.Registrant.LastName+", "+i.SM.Registrant.FirstName+","+r+","+o
var c=i.SM.Type
LobbyistList[lobbyistKey]?n||LobbyistList[lobbyistKey].SMs.push(i.SM):(LobbyistList[lobbyistKey]={LobbyistNumber:i.SM.Registrant.RegistrationNUmberWithSoNum,LobbyistName:i.SM.Registrant.FirstName+" "+i.SM.Registrant.LastName,FirstName:i.SM.Registrant.FirstName,LastName:i.SM.Registrant.LastName,Type:c,Firm:r,FirmTradeName:o,SMs:[]},LobbyistList[lobbyistKey].SMs.push(i.SM))}}),Object.keys(LobbyistList).sort().forEach(function(e,t,s){LobbyistListArray.push(LobbyistList[e])}),LobbyistList={},setAlphaMap(LobbyistListArray,"LastName")}function loadBeneficiaries(){return BeneficiaryArray.length>0?void setAlphaMap(BeneficiaryArray,"BeneficiaryName"):(BeneficiaryList={},BeneficiaryArray=[],$.each(jsonData,function(e,t){var s=[],i="",a=""
t.SM.Beneficiaries&&(s=convertToArrayIfNeccessary(t.SM.Beneficiaries.BENEFICIARY)),$.each(s,function(e,s){"Client"!==s.Type&&(i=s.Name,i+=s.TradeName.trim().length>0?" / "+s.TradeName:"",a=s.TradeName,BeneficiaryList[i]||(BeneficiaryList[i]={BeneficiaryName:i,SMs:[]}),BeneficiaryList[i].SMs.push(t.SM))})}),Object.keys(BeneficiaryList).sort().forEach(function(e,t,s){BeneficiaryArray.push(BeneficiaryList[e])}),BeneficiaryList={},void setAlphaMap(BeneficiaryArray,"BeneficiaryName"))}function loadPOHNames(){if(POHNameArray.length>0)return void setAlphaMap(POHNameArray,"POHName")
POHNameList={},POHNameArray=[],POHSMTracker={}
for(var e=0;e<jsonData.length;e++){var t=jsonData[e],s=[],i="",a=""
t.SM.Communications&&(s=convertToArrayIfNeccessary(t.SM.Communications.Communication))
for(var r=1;r<s.length;r++){var o=s[r]
""!==o.POH_Name&&(i=o.POH_Name+o.POH_Position,a=o.POH_Position,""!==o.POH_Type&&(a+=""!==a?" / "+o.POH_Type:o.POH_Type),POHNameList[i]||(POHNameList[i]={POHName:o.POH_Name,POHPosition:o.POH_Position,POHPosType:a,SMs:[]}),POHSMTracker[i+t.SM.SMNumber]||(POHSMTracker[i+t.SM.SMNumber]=!0,POHNameList[i].SMs.push(t.SM)))}}Object.keys(POHNameList).sort().forEach(function(e,t,s){POHNameArray.push(POHNameList[e])}),POHNameList={},setAlphaMap(POHNameArray,"POHName")}function loadBusOrgClients(){return BusOrgClientArray.length>0?void setAlphaMap(BusOrgClientArray,"BusOrgName"):(BusOrgClientList={},BusOrgClientArray=[],$.each(jsonData,function(e,t){var s=[],i=[],a=""
t.SM.Firms&&(s=convertToArrayIfNeccessary(t.SM.Firms.Firm)),t.SM.Beneficiaries&&(i=convertToArrayIfNeccessary(t.SM.Beneficiaries.BENEFICIARY)),$.each(s,function(e,s){""!==s.Name&&(a=s.Name,a+=""!==s.TradeName?" / "+s.TradeName:"",BusOrgClientList[a]||(BusOrgClientList[a]={BusOrgClientName:a,SMs:[]}),BusOrgClientList[a].SMs.push(t.SM))}),$.each(i,function(e,s){"Client"===s.Type&&(a=s.Name,a+=""!==s.TradeName?" / "+s.TradeName:"",BusOrgClientList[a]||(BusOrgClientList[a]={BusOrgClientName:a,SMs:[]}),BusOrgClientList[a].SMs.push(t.SM))})}),Object.keys(BusOrgClientList).sort().forEach(function(e,t,s){BusOrgClientArray.push(BusOrgClientList[e])}),BusOrgClientList={},void setAlphaMap(BusOrgClientArray,"BusOrgClientName"))}function loadGovFunding(){GovFundingList={},GovFundingArray=[],$.each(jsonData,function(e,t){var s=[],i=""
t.SM.Gmtfundings&&(s=convertToArrayIfNeccessary(t.SM.Gmtfundings.Gmtfunding)),$.each(s,function(e,s){i=s.GMTName,i+=s.Program.trim().length>0?" / "+s.Program:"",GovFundingList[i]||(GovFundingList[i]={GovName:i,SMs:[]}),GovFundingList[i].SMs.push(t.SM)})}),Object.keys(GovFundingList).sort().forEach(function(e,t,s){GovFundingArray.push(GovFundingList[e])}),GovFundingList={},setAlphaMap(GovFundingArray,"GovName")}function loadPrivateFunding(){return PrivateFundingArray.length>0?void setAlphaMap(PrivateFundingArray,"FundingName"):(PrivateFundingList={},PrivateFundingArray=[],$.each(jsonData,function(e,t){var s=[],i=""
t.SM.Privatefundings&&(s=convertToArrayIfNeccessary(t.SM.Privatefundings.Privatefunding)),$.each(s,function(e,s){i=s.Funding,i+=s.Contact.length>0?" / "+s.Contact:"",PrivateFundingList[i]||(PrivateFundingList[i]={FundingName:i,SMs:[]}),PrivateFundingList[i].SMs.push(t.SM)})}),Object.keys(PrivateFundingList).sort().forEach(function(e,t,s){PrivateFundingArray.push(PrivateFundingList[e])}),PrivateFundingList={},void setAlphaMap(PrivateFundingArray,"FundingName"))}function splitSubjectMatters(e){var t=e.split(/[,;]/)
return t}function loadSubjectMatters(){var e={}
$.each(jsonData,function(t,s){var i=splitSubjectMatters(s.SM.SubjectMatter)
for(t=0;t<i.length;t++)i[t].trim().length>0&&!e[i[t].trim()]&&(e[i[t].trim()]=!0)})
var t="",s=[]
Object.keys(e).sort().forEach(function(e,i,a){t+='<option value="'+e+'" selected="selected">'+e+"</option>",s.push(e)})
var i=new Bloodhound({datumTokenizer:Bloodhound.tokenizers.whitespace,queryTokenizer:Bloodhound.tokenizers.whitespace,local:s})
$("#subjectMatterFilter").typeahead({hint:!0,highlight:!0,minLength:1},{name:"matters",source:i,limit:50})}function dynamicSort(e,t){var s=1
return"-"===t[0]&&(s=-1,t=t.substr(1)),function(i,a){var r=0
return r=""!==e?i[e][t]<a[e][t]?-1:i[e][t]>a[e][t]?1:0:i[t]<a[t]?-1:i[t]>a[t]?1:0,r*s}}function decodeMultSelection(e){var t=""
return $(e).prop("options")&&$(e).prop("selectedOptions")&&$(e).prop("options").length===$(e).prop("selectedOptions").length?t="ALL":null!==$(e).val()&&$.each($(e).val(),function(e,s){t+=e>0?",":"",t+=s}),t}function columnFilter(e,t){var s=!1
return(0===e.length||t.toLowerCase().indexOf(e.toLowerCase())>-1)&&(s=!0),s}function dateRangeFilter(e,t,s){var i=!1
return item=moment(s),isNaN(e)&&isNaN(t)?i=!0:isNaN(e)&&item<=t?i=!0:isNaN(t)&&item>=e?i=!0:item>=e&&item<=t&&(i=!0),i}function selectFilter(e,t){var s=!1
return("ALL"===e||e.length>0&&e.toLowerCase().indexOf(t.toLowerCase())>-1)&&(s=!0),s}function filterLobbyistType(e,t){var s=!1
if("ALL"===e&&(s=!0),"Voluntary"===t.Type||"Consultant"===t.Type)e.indexOf("Consultant")>-1&&(s=!0)
else{if(t.Communications){var i=[]
i=convertToArrayIfNeccessary(t.Communications.Communication),$.each(i,function(t,i){e.indexOf(i.LobbyistType)>-1&&(s=!0)})}t.Registrant&&e.indexOf("Sr. Officer")>-1&&(s=!0)}return s}function mergeLobbyistNames(e){var t="",s="",i={}
if(e.Registrant&&(s="<b>"+e.Registrant.FirstName+" "+e.Registrant.LastName+"</b>",t=s+", ",i[s]=!0),e.Communications){var a=[]
a=convertToArrayIfNeccessary(e.Communications.Communication),$.each(a,function(e,a){(a.LobbyistFirstName||a.LobbyistLastName)&&(s="Sr. Officer"===a.LobbyistType?"<b>"+a.LobbyistFirstName+" "+a.LobbyistLastName+"</b>":a.LobbyistFirstName+" "+a.LobbyistLastName,i[s]||(t+=a.LobbyistFirstName+" "+a.LobbyistLastName+", ",i[s]=!0))})}return t=t.substring(0,t.length-2)}function getSMClient(e){var t=[],s=""
return e.Beneficiaries&&(t=convertToArrayIfNeccessary(e.Beneficiaries.BENEFICIARY)),$.each(t,function(e,t){return"Client"===t.Type?(s=t.Name,!1):void 0}),"undefined"==typeof s?"":s}function getSMBusOrg(e){var t=[],s="",i=""
return e.Firms&&(t=convertToArrayIfNeccessary(e.Firms.Firm)),$.each(t,function(e,t){return"Parent"!==t.Type&&"Subsidiary"!==t.Type&&"Other"!==t.Type?(s=t.Name,i=t.TradeName,!1):void 0}),s+(i.trim().length>0?" / "+i:"")}function getSMBeneficiaries(e){var t=[],s=""
return e.Beneficiaries&&(t=convertToArrayIfNeccessary(e.Beneficiaries.BENEFICIARY)),$.each(t,function(e,t){"Client"!==t.Type&&(s+=t.Name,s+=(""!==t.TradeName?" / "+t.TradeName:"")+", ")}),s=s.substring(0,s.length-2)}function getSMFunding(e){var t=[],s=""
return e.Privatefundings&&(t=convertToArrayIfNeccessary(e.Privatefundings.Privatefunding)),$.each(t,function(e,t){s+=t.Funding+", "}),s=s.substring(0,s.length-2)}function showSM(e){var t=""
return t=0===document.location.hostname.length?"Main.html?SM="+e:"/wps/portal/contentonly?vgnextoid="+detailTeaserGUID+"&SM="+e,t+=""!==$("#searchString").val()?"&searchStr="+$("#searchString").val():"",window.location.href=t,!1}function showLR(e,t){var s=""
return s=0===document.location.hostname.length?"Main.html?SM="+e+"&LR="+t:"/wps/portal/contentonly?vgnextoid="+detailTeaserGUID+"&SM="+e+"&LR="+t,s+=""!==$("#searchString").val()?"&searchStr="+$("#searchString").val():"",window.location.href=s,!1}function convertToArrayIfNeccessary(e){var t=[]
return e&&(e.length?t=e:t.push(e)),t}function filterGovAgency(e,t){if(0===e.length)return!0
var s=!1,i=[]
return t.Gmtfundings&&(i=convertToArrayIfNeccessary(t.Gmtfundings.Gmtfunding)),$.each(i,function(t,i){return i.GMTName.toLowerCase().indexOf(e.toLowerCase())>-1||i.Program.toLowerCase().indexOf(e.toLowerCase())>-1?(s=!0,!1):void 0}),s}function filterBeneficary(e,t){if(0===e.length)return!0
var s=!1,i=[]
return t.Beneficiaries&&(i=convertToArrayIfNeccessary(t.Beneficiaries.BENEFICIARY)),$.each(i,function(t,i){return i.Name.toLowerCase().indexOf(e.toLowerCase())>-1||i.TradeName.toLowerCase().indexOf(e.toLowerCase())>-1?(s=!0,!1):void 0}),s}function filterCommunication(e,t,s){if(0===e.length)return!0
var i=!1,a=[]
t.Communications&&(a=convertToArrayIfNeccessary(t.Communications.Communication))
for(var r=0,o=a.length;o>r;r++){var n=a[r]
if(n[s].toLowerCase().indexOf(e.toLowerCase())>-1){i=!0
break}}return i}function filterFunding(e,t){if(0===e.length)return!0
var s=!1,i=[]
return t.Privatefundings&&(i=convertToArrayIfNeccessary(t.Privatefundings.Privatefunding)),$.each(i,function(t,i){return(""+i.Funding).toLowerCase().indexOf(e.toLowerCase())>-1||(""+i.Contact).toLowerCase().indexOf(e.toLowerCase())>-1||(""+i.AgentContact).toLowerCase().indexOf(e.toLowerCase())>-1||(""+i.Agent).toLowerCase().indexOf(e.toLowerCase())>-1?(s=!0,!1):void 0}),s}function resetFilters(){$(".columnSearch").each(function(e){this.value=""}),$(".columnCheckBox").each(function(e){this.checked=!1}),$(".columnSelect").each(function(e){$("#"+this.id).multiselect("selectAll",!1),$("#"+this.id).multiselect("refresh")}),$("#searchString").val(""),$("#searchBtn").show(),$("#advSearchBtnGroup").show(),$("#advSearchString").hide(),$("#searchString").prop("disabled",!1),$("#searchString").show(),filtersApplied()}function toTitleCase(e){var t=e.replace(/(?:^|\s)\w/g,function(e){return e.toUpperCase()})
return t.split(/(?=[A-Z])/).join(" ")}function filtersApplied(){var e=!1,t=""
return $(".columnSearch").each(function(s){null!==this.id&&null!==this.value&&this.value.length>0&&(t+=toTitleCase(this.id.replace("Search","").replace("Filter",""))+" : "+this.value+"<br>",e=!0)}),$(".columnCheckBox").each(function(s){null!==this.id&&this.checked&&(t+=toTitleCase(this.id.replace("Ind",""))+" : "+this.checked+"<br>",e=!0)}),$(".columnSelect").each(function(s){if(null!==this.id&&this.selectedOptions&&this.selectedOptions.length!=this.options.length){for(t+=toTitleCase(this.id).replace("Filter","")+" : ",i=0;i<this.selectedOptions.length;i++)t+=this.selectedOptions[i].value+", "
t=t.slice(0,-2),t+="<br>",e=!0}}),$(".datepicker").each(function(s){null!==this.id&&this.value.length>0&&(t+=toTitleCase(this.id)+" : "+this.value+"<br>",e=!0)}),$("#searchString").val().length>0?(e=!0,$("#advSearchBtnGroup").hide()):$("#advSearchBtnGroup").show(),$("#advSearchString").val(t.replace(/<br>/g," ; ").slice(0,-3)),$("#lrServiceBar").tooltip("hide").attr("data-original-title",t).tooltip("fixTitle").tooltip("show"),e?$("#advSearchResetGroup").show():$("#advSearchResetGroup").hide(),e}function resetAlphaMap(){alphaMap={}
for(var e="1ABCDEFGHIJKLMNOPQRSTUVWXYZ".split(""),t=0;t<e.length;t++)alphaMap[e[t]]=!1}function setAlphaMap(e,t){if(filtersApplied())$("#alphaPagination").hide()
else{$("#alphaPagination").show(),resetAlphaMap()
for(var s=0;s<e.length;s++){var i=e[s][t].charAt(0)
i.match(/[a-z]/i)?alphaMap[i.toUpperCase()]=!0:alphaMap[1]=!0}var a=!1
Object.keys(alphaMap).forEach(function(e,t,s){alphaMap[e]?(a||(a=!0,currentAlpha="1"===e?"#":e),$("#alpha-"+e).removeClass("disabled")):$("#alpha-"+e).addClass("disabled")})}}function listDetailRow(e,t,s,i){var a="",r=rptColumns[selectedReport].Cols,o=mergeLobbyistNames(t),n=getSMClient(t),l=getSMBusOrg(t),c=getSMBeneficiaries(t),d=getSMFunding(t)
showItem=!0
var u="lrRow"+s
if(showItem&&(showItem=filterSearch(t,i)),showItem&&(showItem=columnFilter(i.RegNoSearch,t.SMNumber)),showItem&&(showItem=columnFilter(i.LobbyistNameSearch,o)),showItem&&(showItem=selectFilter(i.LobbyistTypes,t.Type)),showItem&&(showItem=selectFilter(i.SMStatuses,t.Status)),showItem&&(showItem=columnFilter(i.SMSearch,t.SubjectMatter)),showItem&&(showItem=columnFilter(i.ClientSearch,n)),showItem&&(showItem=filterBeneficary(i.BeneficiarySearch,t)),showItem&&(showItem=filterGovAgency(i.GovAgencySearch,t)),showItem&&(showItem=filterFunding(i.FinancialContributorSearch,t)),showItem&&(showItem=filterCommunication(i.POHNameSearch,t,"POH_Name")),showItem&&(showItem=filterCommunication(i.POHPositionSearch,t,"POH_Position")),showItem&&(showItem=filterCommunication(i.POHOfficeSearch,t,"POH_Office")),showItem&&i.CommitteeChk&&!t.Meetings&&(showItem=!1),showItem&&i.GrassRootsChk&&!t.Grassroots&&(showItem=!1),showItem&&(showItem=dateRangeFilter(i.DateFrom,i.DateTo,t.InitialApprovalDate)),showItem){a+='<tr id="'+u+'">'
for(var h=0;h<r.length;h++)"SMLLobbyist"===r[h].column&&(a+='<td class="'+r[h]["class"]+'" style="'+r[h].style+'">'+highlightSearch(e.LastName+", "+e.FirstName,i)+"</td>"),"SMLBeneficiary"===r[h].column&&(a+='<td class="'+r[h]["class"]+'" style="'+r[h].style+'">'+highlightSearch(c,i)+"</td>"),"SMLLobbyistNames"===r[h].column&&(a+='<td class="'+r[h]["class"]+'" style="'+r[h].style+'">'+highlightSearch(o,i)+"</td>"),"SMLLobbyistType"===r[h].column&&(a+='<td class="'+r[h]["class"]+'" style="'+r[h].style+'">'+t.Type+"</td>"),"SMLClient"===r[h].column&&(a+='<td class="'+r[h]["class"]+'" style="'+r[h].style+'">'+highlightSearch(n,i)+"</td>"),"SMLBusOrg"===r[h].column&&(a+='<td class="'+r[h]["class"]+'" style="'+r[h].style+'">'+highlightSearch(l,i)+"</td>"),"SMLBusOrgClient"===r[h].column&&(a+='<td class="'+r[h]["class"]+'" style="'+r[h].style+'">'+highlightSearch(e.BusOrgClientName,i)+"</td>"),"SMLFunding"===r[h].column&&(a+='<td class="'+r[h]["class"]+'" style="'+r[h].style+'">'+highlightSearch(e.FundingName,i)+"</td>"),"SMLPrivateFunding"===r[h].column&&(a+='<td class="'+r[h]["class"]+'" style="'+r[h].style+'">'+highlightSearch(d,i)+"</td>"),"SMLSubjectMatter"===r[h].column&&(a+='<td class="'+r[h]["class"]+'" style="'+r[h].style+'">'+highlightSearch(t.SubjectMatter.replace(";","; "),i)+"</td>"),"SMLStatus"===r[h].column&&(a+='<td class="'+r[h]["class"]+'" style="'+r[h].style+'">'+highlightSearch(t.Status,i)+"</td>"),"SMLInitFileDate"===r[h].column&&(a+='<td class="'+r[h]["class"]+'" style="'+r[h].style+'">'+highlightSearch(t.InitialApprovalDate,i)+"</td>"),"SMLSubjectMatterNo"===r[h].column&&(a+='<td class="'+r[h]["class"]+'" style="'+r[h].style+'"><button onclick="showSM(\''+t.SMNumber+"')\" >"+highlightSearch(t.SMNumber,i)+"</button></td>"),"SMLLobRegNo"===r[h].column&&(a+='<td class="'+r[h]["class"]+'" style="'+r[h].style+'"><button onclick="showLR(\''+t.SMNumber+"','"+e.LobbyistNumber+"')\" >"+highlightSearch(e.LobbyistNumber,i)+"</td>"),"SMLPOHName"===r[h].column&&(a+='<td class="'+r[h]["class"]+'" style="'+r[h].style+'">'+highlightSearch(e.POHName,i)+"</td>"),"SMLPOHPosition"===r[h].column&&(a+='<td class="'+r[h]["class"]+'" style="'+r[h].style+'">'+highlightSearch(e.POHPosition,i)+"</td>"),"SMLPOHPosType"===r[h].column&&(a+='<td class="'+r[h]["class"]+'" style="'+r[h].style+'">'+highlightSearch(e.POHPosType,i)+"</td>")
a+="</tr>"}return a}function updatePageTable(e){""===e&&(e+="<tr id='nowRows'><td colspan='25'>No Rows Selected</td></tr>"),$("#lobbytable tbody").html(e).trigger("update"),$("#loader").hide()}function generatePOHListing(){var e="<tr><td colspan='10'>some of the data in this report is not in the data extract</td></tr>"
$("#lobbytable tbody").html(e).trigger("update"),$("#loader").hide()}function getPageLobbyData(e){totalJSONRows=0
for(var t=[],s=!0,i=0,a="",r=getHighLightFilterOptions(),o=0,n=LobbyistListArray.length;n>o;o++){var l=LobbyistListArray[o]
s=!0,a="loobyregistryrow"+i,s&&(s=filterSearch(l,r)),s&&(s=selectFilter(r.LobbyistTypes,l.Type))
var c=!1
if(s)for(var d=0,u=l.SMs.length;u>d;d++){var h=l.SMs[d],m=mergeLobbyistNames(h),y=getSMClient(h),b=!0
if(b&&(b=columnFilter(r.RegNoSearch,h.SMNumber)),b&&(b=columnFilter(r.LobbyistNameSearch,m)),b&&(b=selectFilter(r.LobbyistTypes,h.Type)),b&&(b=selectFilter(r.SMStatuses,h.Status)),b&&(b=columnFilter(r.SMSearch,h.SubjectMatter)),b&&(b=columnFilter(r.ClientSearch,y)),b&&(b=filterBeneficary(r.BeneficiarySearch,h)),b&&(b=filterGovAgency(r.GovAgencySearch,h)),b&&(b=filterFunding(r.FinancialContributorSearch,h)),b&&(b=filterCommunication(r.POHNameSearch,h,"POH_Name")),b&&(b=filterCommunication(r.POHPositionSearch,h,"POH_Position")),b&&(b=filterCommunication(r.POHOfficeSearch,h,"POH_Office")),b&&r.CommitteeChk&&!h.Meetings&&(b=!1),b&&r.GrassRootsChk&&!h.Grassroots&&(b=!1),b){c=!0
break}}"A"===e&&l.LastName.charAt(0).toUpperCase()!==currentAlpha&&(s=!1),s&&c&&(totalJSONRows++,("A"===e||"N"===e&&totalJSONRows>=r.startIdx&&totalJSONRows<r.endIdx)&&t.push(l))}return t}function generateLobbyistListing(e){for(var t="",s=getHighLightFilterOptions(),i=0,a=e.length;a>i;i++)for(var r=e[i],o=0,n=r.SMs.length;n>o;o++)t+=listDetailRow(r,r.SMs[o],i,s)
updatePageTable(t)}function generateNoDataListing(){strRows="<tr id='nowRows'><td colspan='25'>No Rows Selected</td></tr>",$("#lobbytable tbody").html(strRows).trigger("update"),$("#PageStatus").hide()}function getPageBenData(e){totalJSONRows=0
var t=!0,s=[],i=getHighLightFilterOptions()
return $.each(BeneficiaryArray,function(a,r){t=!0,t&&(t=filterSearch(r,i)),t&&(t=columnFilter(i.BeneficiarySearch,r.BeneficiaryName))
var o=!1
t&&$.each(r.SMs,function(e,t){var s=mergeLobbyistNames(t),a=getSMClient(t),r=!0
return r&&(r=filterSearch(t,i)),r&&(r=columnFilter(i.RegNoSearch,t.SMNumber)),r&&(r=columnFilter(i.LobbyistNameSearch,s)),r&&(r=selectFilter(i.LobbyistTypes,t.Type)),r&&(r=selectFilter(i.SMStatuses,t.Status)),r&&(r=columnFilter(i.SMSearch,t.SubjectMatter)),r&&(r=columnFilter(i.ClientSearch,a)),r&&(r=filterBeneficary(i.BeneficiarySearch,t)),r&&(r=filterGovAgency(i.GovAgencySearch,t)),r&&(r=filterFunding(i.FinancialContributorSearch,t)),r&&(r=filterCommunication(i.POHNameSearch,t,"POH_Name")),r&&(r=filterCommunication(i.POHPositionSearch,t,"POH_Position")),r&&(r=filterCommunication(i.POHOfficeSearch,t,"POH_Office")),r&&i.CommitteeChk&&!t.Meetings&&(r=!1),r&&i.GrassRootsChk&&!t.Grassroots&&(r=!1),r&&(r=dateRangeFilter(i.DateFrom,i.DateTo,t.InitialApprovalDate)),r?(o=!0,!1):void 0}),"A"===e&&(r.BeneficiaryName.charAt(0).toUpperCase().match(/[a-z]/i)&&r.BeneficiaryName.charAt(0).toUpperCase()!==currentAlpha&&(t=!1),r.BeneficiaryName.charAt(0).toUpperCase().match(/[a-z]/i)||"#"===currentAlpha||(t=!1)),t&&o&&(totalJSONRows++,("A"===e||"N"===e&&totalJSONRows>=i.startIdx&&totalJSONRows<i.endIdx)&&s.push(r))}),s}function generateBenListing(e){var t="",s=0,i=getHighLightFilterOptions()
$.each(e,function(e,a){for(s++,e=0,len=a.SMs.length;e<len;e++){var r=a.SMs[e]
t+=listDetailRow(a,r,s,i)}}),updatePageTable(t)}function getPagePOHNameData(e){totalJSONRows=0
var t=0,s=!0,i=[],a=getHighLightFilterOptions()
return $.each(POHNameArray,function(r,o){s=!0,s&&(s=filterSearch(o,a)),s&&(s=columnFilter(a.POHNameSearch,o.POHName))
var n=!1
s&&(t=0,$.each(o.SMs,function(e,s){var i=mergeLobbyistNames(s),r=getSMClient(s),o=!0
return o&&(o=filterSearch(s,a)),o&&(o=columnFilter(a.RegNoSearch,s.SMNumber)),o&&(o=columnFilter(a.LobbyistNameSearch,i)),o&&(o=selectFilter(a.LobbyistTypes,s.Type)),o&&(o=selectFilter(a.SMStatuses,s.Status)),o&&(o=columnFilter(a.SMSearch,s.SubjectMatter)),o&&(o=columnFilter(a.ClientSearch,r)),o&&(o=filterBeneficary(a.BeneficiarySearch,s)),o&&(o=filterGovAgency(a.GovAgencySearch,s)),o&&(o=filterFunding(a.FinancialContributorSearch,s)),o&&(o=filterCommunication(a.POHNameSearch,s,"POH_Name")),o&&(o=filterCommunication(a.POHPositionSearch,s,"POH_Position")),o&&(o=filterCommunication(a.POHOfficeSearch,s,"POH_Office")),o&&a.CommitteeChk&&!s.Meetings&&(o=!1),o&&a.GrassRootsChk&&!s.Grassroots&&(o=!1),o&&(o=dateRangeFilter(a.DateFrom,a.DateTo,s.InitialApprovalDate)),o?(n=!0,t++,!1):void 0})),"A"===e&&(o.POHName.charAt(0).toUpperCase().match(/[a-z]/i)&&o.POHName.charAt(0).toUpperCase()!==currentAlpha&&(s=!1),o.POHName.charAt(0).toUpperCase().match(/[a-z]/i)||"#"===currentAlpha||(s=!1)),s&&n&&(totalJSONRows+=t,("A"===e||"N"===e&&totalJSONRows>=a.startIdx&&totalJSONRows<a.endIdx)&&i.push(o))}),i}function generatePOHNameListing(e){var t="",s=0,i=getHighLightFilterOptions()
$.each(e,function(e,a){s++
for(var r=0,o=a.SMs.length;o>r;r++){var n=a.SMs[r]
t+=listDetailRow(a,n,s,i)}}),updatePageTable(t)}function getPageBusOrgClientData(e){totalJSONRows=0
var t=!0,s=[],i=getHighLightFilterOptions()
return $.each(BusOrgClientArray,function(a,r){t=!0,t&&(t=filterSearch(r,i)),t&&(t=columnFilter(i.BusOrgNameSearch,r.BusOrgName))
var o=!1
t&&$.each(r.SMs,function(e,t){var s=mergeLobbyistNames(t),a=getSMClient(t),r=!0
return r&&(r=filterSearch(t,i)),r&&(r=columnFilter(i.RegNoSearch,t.SMNumber)),r&&(r=columnFilter(i.LobbyistNameSearch,s)),r&&(r=selectFilter(i.LobbyistTypes,t.Type)),r&&(r=selectFilter(i.SMStatuses,t.Status)),r&&(r=columnFilter(i.SMSearch,t.SubjectMatter)),r&&(r=columnFilter(i.ClientSearch,a)),r&&(r=filterBeneficary(i.BeneficiarySearch,t)),r&&(r=filterGovAgency(i.GovAgencySearch,t)),r&&(r=filterFunding(i.FinancialContributorSearch,t)),r&&(r=filterCommunication(i.POHNameSearch,t,"POH_Name")),r&&(r=filterCommunication(i.POHPositionSearch,t,"POH_Position")),r&&(r=filterCommunication(i.POHOfficeSearch,t,"POH_Office")),r&&i.CommitteeChk&&!t.Meetings&&(r=!1),r&&i.GrassRootsChk&&!t.Grassroots&&(r=!1),r&&(r=dateRangeFilter(i.DateFrom,i.DateTo,t.InitialApprovalDate)),r?(o=!0,!1):void 0}),"A"===e&&(r.BusOrgClientName.charAt(0).toUpperCase().match(/[a-z]/i)&&r.BusOrgClientName.charAt(0).toUpperCase()!==currentAlpha&&(t=!1),r.BusOrgClientName.charAt(0).toUpperCase().match(/[a-z]/i)||"#"===currentAlpha||(t=!1)),t&&o&&(totalJSONRows++,("A"===e||"N"===e&&totalJSONRows>=i.startIdx&&totalJSONRows<i.endIdx)&&s.push(r))}),s}function generateBusOrgClientListing(e){var t="",s=0,i=getHighLightFilterOptions()
$.each(e,function(e,a){for(s++,e=0,len=a.SMs.length;e<len;e++){var r=a.SMs[e]
t+=listDetailRow(a,r,s,i)}}),updatePageTable(t)}function getPagePrivateFundingSMData(e){totalJSONRows=0
var t=!0,s=[],i=getHighLightFilterOptions()
return $.each(PrivateFundingArray,function(a,r){showParent=!0,showParent&&(showParent=filterSearch(r,i)),showParent&&(showParent=columnFilter(i.FinancialContributorSearch,r.FundingName))
var o=!1
showParent&&$.each(r.SMs,function(e,s){var a=mergeLobbyistNames(s),r=getSMClient(s),n=!0
return n&&(n=filterSearch(s,i)),n&&(n=columnFilter(i.RegNoSearch,s.SMNumber)),n&&(n=columnFilter(i.LobbyistNameSearch,a)),n&&(n=selectFilter(i.LobbyistTypes,s.Type)),n&&(n=selectFilter(i.SMStatuses,s.Status)),n&&(n=columnFilter(i.SMSearch,s.SubjectMatter)),n&&(n=columnFilter(i.ClientSearch,r)),n&&(n=filterBeneficary(i.BeneficiarySearch,s)),n&&(n=filterGovAgency(i.GovAgencySearch,s)),t&&(t=filterCommunication(i.POHNameSearch,s,"POH_Name")),t&&(t=filterCommunication(i.POHPositionSearch,s,"POH_Position")),n&&(n=filterCommunication(i.POHOfficeSearch,s,"POH_Office")),n&&i.CommitteeChk&&!s.Meetings&&(n=!1),n&&i.GrassRootsChk&&!s.Grassroots&&(n=!1),n&&(n=dateRangeFilter(i.DateFrom,i.DateTo,s.InitialApprovalDate)),n?(o=!0,!1):void 0}),"A"===e&&(r.FundingName.charAt(0).match(/[a-z]/i)&&r.FundingName.charAt(0)!==currentAlpha&&(showParent=!1),r.FundingName.charAt(0).match(/[a-z]/i)||"#"===currentAlpha||(showParent=!1)),showParent&&o&&(totalJSONRows++,("A"===e||"N"===e&&totalJSONRows>=i.startIdx&&totalJSONRows<i.endIdx)&&s.push(r))}),s}function generatePrivateFundingListing(e){var t=getHighLightFilterOptions(),s=!0,i="",a=0
filtersApplied()
$.each(e,function(e,r){for(s=!0,a++,e=0,len=r.SMs.length;e<len;e++)i+=listDetailRow(r,r.SMs[e],a,t)}),updatePageTable(i)}function getPageSMData(){totalJSONRows=0
var e=!0,t=[],s=getHighLightFilterOptions()
return $.each(jsonData,function(i,a){var r=a.SM,o=mergeLobbyistNames(r),n=getSMClient(r)
e=!0,e&&(e=filterSearch(r,s)),e&&(e=columnFilter(s.RegNoSearch,r.SMNumber)),e&&(e=columnFilter(s.LobbyistNameSearch,o)),e&&(e=selectFilter(s.LobbyistTypes,r.Type)),e&&(e=selectFilter(s.SMStatuses,r.Status)),e&&(e=columnFilter(s.SMSearch,r.SubjectMatter)),e&&(e=columnFilter(s.ClientSearch,n)),e&&(e=filterBeneficary(s.BeneficiarySearch,r)),e&&(e=filterGovAgency(s.GovAgencySearch,r)),e&&(e=filterFunding(s.FinancialContributorSearch,r)),e&&(e=filterCommunication(s.POHNameSearch,r,"POH_Name")),e&&(e=filterCommunication(s.POHPositionSearch,r,"POH_Position")),e&&(e=filterCommunication(s.POHOfficeSearch,r,"POH_Office")),e&&(e=dateRangeFilter(s.DateFrom,s.DateTo,r.InitialApprovalDate)),e&&s.CommitteeChk&&!r.Meetings&&(e=!1),e&&s.GrassRootsChk&&!r.Grassroots&&(e=!1),e&&(totalJSONRows++,totalJSONRows>=s.startIdx&&totalJSONRows<s.endIdx&&t.push(r))}),t}function generateSMListing(e){var t="",s=0,i=getHighLightFilterOptions()
$.each(e,function(e,a){s++,t+=listDetailRow(e,a,s,i)}),updatePageTable(t)}function setUpSearchFilters(){$("#statusFilter").multiselect({onChange:function(e,t,s){},onSelectAll:function(e,t,s){}}),$("#pohTypeFilter").multiselect({includeSelectAllOption:!0,numberDisplayed:1}),$("#lobbyistTypeFilter").multiselect({includeSelectAllOption:!0})}function setUpEvents(){$("#searchBtn").click(function(){0===$("#searchString").val().length?$("#advSearchBtnGroup").show():$("#advSearchBtnGroup").hide(),showListing()}),$("#pageSize").multiselect({buttonWidth:"55px",buttonClass:"pull-right",onChange:function(e,t,s){rowsPerPage=Number($("#pageSize").val()),$("#numberPageSelection").bootpag({page:1}),nextRow=1,showListing()}}),$("#pageSize").next().css({"margin-top":"-8px"}),$("#pageSize").next().find("button").css("height","25px"),$("#searchString").keypress(function(e){var t=e.which||e.keyCode||0
13!==t&&9!==t||showListing()}),$(".input-daterange").datepicker({todayBtn:!0,forceParse:!1,autoclose:!0,format:"yyyy-mm-dd",date:new Date,todayHighlight:!0}),$(".hasclear").keyup(function(){var e=$(this)
e.next("span").toggle(Boolean(e.val()))}),$(".hastaclear").keyup(function(){var e=$(this)
e.parent().next("span").toggle(Boolean(e.val()))}),$(".clearer").hide($(this).prev("input").val()),$(".clearerta").hide($(this).prev("input").val()),$(".clearer").click(function(){$(this).prev("input").val("").focus(),$(this).hide()}),$("#searchStringClear").click(function(){$(this).prev("input").val("").focus(),$(this).hide(),$("#advSearchBtnGroup").show(),showListing()}),$(".clearerta").click(function(){$(".typeahead").typeahead("val",""),$(this).hide()}),$("#numberPageSelection").bootpag({total:rowsPerPage,page:1,maxVisible:5,leaps:!0,firstLastUse:!0,first:"←",last:"→",wrapClass:"pagination",activeClass:"active",disabledClass:"disabled",nextClass:"next",prevClass:"prev",lastClass:"last",firstClass:"first"}).on("page",function(e,t){nextRow=(t-1)*rowsPerPage+1,showListing(),$("#PageNo").html(t)}),$(".alphaIdx").click(function(e){return currentAlpha=e.target.innerHTML,showListing(),!1}),$(".lrCats").on("click",function(){selectedReport=this.id,nextRow=1,$("#numberPageSelection").bootpag({page:1}),$("#PageNo").html("1"),initListing(),showListing()}),$("#advSearchApplyBtn").on("click",function(){$("#modalSearch").modal("hide"),filtersApplied()&&($("#searchString").val(""),$("#searchString").hide(),$("#searchBtn").hide(),$("#advSearchString").show()),initListing(),showListing()}),$("#resetAdvSearchBtn").on("click",function(){resetFilters()}),$("#resetBtn").on("click",function(){resetFilters(),showListing()}),$("#lrServiceBar").tooltip()}function jsonEventsCallBack(e){jsonData=e.sort(dynamicSort("SM","-SMNumber")),loadSubjectMatters(),setUpSearchFilters(),setUpEvents(),initListing(),showListing(),initialLoad=!1}function initApp(){if("www1.toronto.ca"!=document.location.host){$.support.cors=!0
var e=navigator.userAgent,t=99,s="/City Of Toronto/Sandbox/Steve/LobbyRegistry2/disclosure_active.json"
0===document.location.hostname.length&&(s="disclosure_active.json"),e.indexOf("MSIE")>1&&(t=parseInt(e.substr(e.indexOf("MSIE")+5,5))),13>t?$.ajax({type:"GET",url:s,crossDomain:!0,dataType:"json",success:function(e){jsonEventsCallBack(e)},error:function(e,t,s){console.log(e.status),console.log(s)}}):$.ajax({type:"GET",url:s,crossDomain:!0,dataType:"json",success:function(e){jsonEventsCallBack(e)},error:function(e,t,s){console.log(e.status),console.log(s)}})}else $.getJSON("disclosure_active.json",function(e){jsonEventsCallBack(e)})}function initListing(){switch($("#numPagination").hide(),$("#alphaPagination").hide(),currentAlpha="A",nextRow=1,selectedReport){case"LobbyRpt":loadLobbyists()
break
case"BenRpt":loadBeneficiaries()
break
case"SMRpt":break
case"POHOffRpt":break
case"POHNameRpt":loadPOHNames()
break
case"BusOrgClientRpt":loadBusOrgClients()
break
case"GovRpt":loadGovFunding()
break
case"FinRpt":loadPrivateFunding()}"A"===rptColumns[selectedReport].Idx?($("#alphaPagination").show(),$("#PageStatus").hide()):($("#numPagination").show(),$("#PageStatus").show())}function turnOnAlphaNumericPaging(){$("#numPagination").hide(),$("#PageStatus").hide(),$("#alphaPagination").show()}function turnOnNumericPaging(){$("#numPagination").show(),$("#PageStatus").show(),$("#alphaPagination").hide()
var e=0
totalJSONRows>0?(e=Math.ceil(totalJSONRows/rowsPerPage),$("#numberPageSelection").bootpag({total:e}),$("#PageStatus").show()):($("#numberPageSelection").bootpag({total:1}),$("#PageStatus").hide()),$("#NoPages").html(e),$("#TotalRows").html(totalJSONRows),$("#PageNo").html("1")}function showListing(){$("#loader").show()
var e=rptColumns[selectedReport].Idx
filtersApplied()&&"A"===rptColumns[selectedReport].Idx&&(e="N")
var t=[]
switch(showHideColumns(),writeListingHeaders(),selectedReport){case"LobbyRpt":t=getPageLobbyData(e),generateLobbyistListing(t)
break
case"BenRpt":t=getPageBenData(e),generateBenListing(t)
break
case"SMRpt":if(t=getPageSMData(e),totalJSONRows>0){var s=Math.ceil(totalJSONRows/rowsPerPage)
$("#numberPageSelection").bootpag({total:s}),generateSMListing(t)}else generateNoDataListing()
break
case"POHCommRpt":generatePOHListing()
break
case"POHNameRpt":t=getPagePOHNameData(e),generatePOHNameListing(t)
break
case"BusOrgClientRpt":t=getPageBusOrgClientData(e),generateBusOrgClientListing(t)
break
case"GovRpt":t=getPageGovFundingSMData(e),generateGovFundingListing(t)
break
case"FinRpt":t=getPagePrivateFundingSMData(e),generatePrivateFundingListing(t)
break
default:alert("not implemented yet")}"N"===e?turnOnNumericPaging():turnOnAlphaNumericPaging()}function getLobbyistData(e,t){var s="",i=getHighLightFilterOptions()
return $.each(jsonData,function(a,r){r.SM.Communications&&$.each(r.SM.Communications.Communication,function(o,n){return n.LobbyistFirstName===t&&n.LobbyistLastName===e?(s+=generateSMReportRow(a,r,i),!1):void 0})}),s}function columnWidths(){for(var e=rptColumns[selectedReport].Cols,t=[],s=0;s<e.length;s++)t.push(rptColumnHdrs[e[s].column].size)
return t}function addHeaders(){for(var e=[],t=rptColumns[selectedReport].Cols,s=0;s<t.length;s++)e.push({text:rptColumnHdrs[t[s].column].header,style:"sctableheader"})
return e}function generatePDF(){var e=(new Date,{})
e.pageSize="LEGAL",e.footer=function(e,t){return{columns:[{text:"http://www1.toronto.ca/wps/portal/contentonly?vgnextoid=cf1fb7537e35f310VgnVCM10000071d60f89RCRD",style:"footertext",margin:15},{text:e.toString()+" of "+t,alignment:"right",style:"footertext",margin:15}]}},e.header={columns:[{image:"logo",width:80,margin:[0,20,0,10]},{text:"Office of the Lobbyist Registrar",margin:[0,20,20,10],style:"headertext"}]},e.pageMargins=[20,70,20,60],e.styles={},e.styles.reporttitle={fontSize:28,bold:!0,alignment:"center",color:"#000000",margin:[0,70,0,20]},e.styles.measuretitle={fontSize:16,bold:!0,alignment:"left",color:"#000000",margin:[0,0,0,10],pageBreak:"before"},e.styles.scorecardcattitle={fontSize:12,bold:!0,alignment:"left"},e.styles.scorecard={margin:[0,0,0,15]},e.styles.trendtitle={fontSize:14,bold:!0,alignment:"left",color:"#555",margin:[0,0,0,5]},e.styles.reportdate={fontSize:16,bold:!0,alignment:"center"},e.styles.cmo={fontSize:20,bold:!0,alignment:"center"},e.styles.headertext={fontSize:12,color:"#aaa",alignment:"right",width:"50%"},e.styles.sctableheader={fontSize:8,color:"#000",alignment:"center",fillColor:"#eeeeee"},e.styles.footertext={color:"#aaa",fontSize:8},e.styles.trendanalysis={fontSize:10},e.styles.tableheader={fontSize:10,bold:!0,fillColor:"#eeeeee"},e.styles.cityper={fontSize:10,alignment:"left",margin:[0,5,0,0]},e.styles.datasource={fontSize:10,alignment:"left",margin:[0,10,0,10]},e.styles.narrative={fontSize:10,alignment:"left",margin:[0,10,0,0]},e.styles.positive={fillColor:"#dff0d8",fontSize:8},e.styles.negative={fillColor:"#f2dede",fontSize:8},e.styles.stable={fillColor:"#fcf8e3",fontSize:8},e.styles.graphtitle={fontSize:14,bold:!0,alignment:"left",color:"#555",margin:[0,20,0,0]},e.styles.Monthly={fontSize:8},e.styles.Quarterly={fontSize:8},e.styles.Seasonal={fontSize:8},e.styles.Yearly={fontSize:8},e.styles.termsheader={fontSize:12,bold:!0,margin:[50,500,50,0]},e.styles.termstext={fontSize:8,margin:[50,5,0,0]},e.styles["N/A"]={fillColor:"#eee"},e.styles.tblcol={margin:[0,0,0,0],fontSize:8},e.images={},e.images.logo="data:image/png;base64,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",e.content=[],e.content.push({text:"Toronto's Lobby Registry",style:"reporttitle"}),e.content.push({text:"Office of the Lobbyist Registrar",style:"cmo"}),e.content.push({text:"Terms of Use Disclaimer",style:"termsheader"}),e.content.push({text:'This portion of the City of Toronto web site is being used for the purpose of disclosure of information contained in the City\'s Lobbyist Registry System (the "System") under Chapter 140, Lobbying, of the City of Toronto Municipal Code. This site is being made available to allow members of the public to readily obtain information regarding the activities of lobbyists involved in lobbying the City of Toronto.',style:"termstext"}),e.content.push({text:"Users of this portion of the City of Toronto web site should be aware of the following:",style:"termstext"}),e.content.push({text:"(i) Despite the Lobbyist Registrar's authority to verify and clarify the information submitted to the System, it is the lobbyists' exclusive responsibility to ensure that all submitted information is accurate and correct and the information submitted by lobbyists to the System may be posted as received; and",style:"termstext"}),e.content.push({text:'ii) The City of Toronto provides the System on an "as is", "as available", basis. The City does not make any express or implied warranties, representations or endorsements with respect to the system, including but not limited to, warranties as to usefulness, completeness, accuracy and reliability and the City will not accept any responsibility for data improperly entered. In addition, the City does not represent and warrant that the system will be available or meet your requirements, that access will be uninterrupted, that there will be no delays, failures or errors or omissions or loss of transmitted information, that no viruses or other contaminating or destructive properties will be transmitted or that no damage will occur to your computer system. As a user of the System, you accept sole responsibility for adequate protection and backup of your data, hardware and software and to take reasonable and appropriate precautions against viruses and other contaminating or destructive properties.',style:"termstext"})
var t={}
t.style="scorecard",t.table={},t.table.widths=columnWidths(),t.table.headerRows=1,t.table.body=[],t.table.body[0]=[],$.merge(t.table.body[0],addHeaders()),e.content.push({text:"Lobbyist Report",style:"measuretitle",pageBreak:"before"})
var s=this[rptColumns[selectedReport].DataSource],i=1
$.each(s,function(e,s){var a=[]
return s.SMs?a=s.SMs:a.push(s.SM),$.each(a,function(e,a){var r=mergeLobbyistNames(a).replace(/<\/?b>/g,""),o=getSMClient(a),n=getSMBusOrg(a),l=getSMBeneficiaries(a),c=getSMFunding(a)
t.table.body[i]=[]
for(var d=0;d<rptColumns[selectedReport].Cols.length;d++)"SMLLobbyist"===rptColumns[selectedReport].Cols[d].column&&t.table.body[i].push({text:s.LobbyistName,style:"tblcol"}),"SMLLobbyistNames"===rptColumns[selectedReport].Cols[d].column&&t.table.body[i].push({text:r,style:"tblcol"}),"SMLPOHName"===rptColumns[selectedReport].Cols[d].column&&t.table.body[i].push({text:s.POHName,style:"tblcol"}),"SMLPOHPosition"===rptColumns[selectedReport].Cols[d].column&&t.table.body[i].push({text:s.POHPosition,style:"tblcol"}),"SMLPOHPosType"===rptColumns[selectedReport].Cols[d].column&&t.table.body[i].push({text:s.POHPosType,style:"tblcol"}),"SMLFunding"===rptColumns[selectedReport].Cols[d].column&&t.table.body[i].push({text:s.FundingName,style:"tblcol"}),"SMLPrivateFunding"===rptColumns[selectedReport].Cols[d].column&&t.table.body[i].push({text:c,style:"tblcol"}),"SMLGovAgency"===rptColumns[selectedReport].Cols[d].column&&t.table.body[i].push({text:s.GovName,style:"tblcol"}),"SMLLobbyistType"===rptColumns[selectedReport].Cols[d].column&&t.table.body[i].push({text:a.Type,style:"tblcol"}),"SMLBeneficiary"===rptColumns[selectedReport].Cols[d].column&&t.table.body[i].push({text:l,style:"tblcol"}),"SMLBusOrg"===rptColumns[selectedReport].Cols[d].column&&t.table.body[i].push({text:n,style:"tblcol"}),"SMLClient"===rptColumns[selectedReport].Cols[d].column&&t.table.body[i].push({text:o,style:"tblcol"}),"SMLSubjectMatter"===rptColumns[selectedReport].Cols[d].column&&t.table.body[i].push({text:a.SubjectMatter,style:"tblcol"}),"SMLStatus"===rptColumns[selectedReport].Cols[d].column&&t.table.body[i].push({text:a.Status,style:"tblcol"}),"SMLInitFileDate"===rptColumns[selectedReport].Cols[d].column&&t.table.body[i].push({text:a.InitialApprovalDate,style:"tblcol"}),"SMLSubjectMatterNo"===rptColumns[selectedReport].Cols[d].column&&t.table.body[i].push({text:a.SMNumber,style:"tblcol"}),"SMLLobRegNo"===rptColumns[selectedReport].Cols[d].column&&t.table.body[i].push({text:s.LobbyistNumber,style:"tblcol"})
i++}),i>30?!1:void 0}),e.content.push(t),pdfMake.createPdf(e).open()}function parseBusinessAddress(e){var t={}
return t.Line=e.AddressLine1,t.Line+=e.AddressLine2?"<br>"+e.AddressLine2:"",t.CityProv=e.City+", "+e.Province,t.PostCty=e.Country+", "+e.PostalCode,t.Phone=e.Phone,t.Addr=t.Line,t.Addr+=t.CityProv?"<br>"+t.CityProv:"",t.Addr+=t.PostCty?"<br>"+t.PostCty:"",t}function compareCommType(e,t){return CommSortOrder[e]<CommSortOrder[t]?-1:CommSortOrder[e]>CommSortOrder[t]?1:0}function fillDetails(e,t,s,i){var a="",r=0,o=[],n=null===s
s?$("#headerText").text("Lobbyist Details"):$("#headerText").text("Subject Matter Details"),$("#BackTo").prop("href","/wps/portal/contentonly?vgnextoid="+listGUID)
var l={}
if($.each(e,function(e,s){return s.SM.SMNumber===t?(l=s.SM,!1):void 0}),$.isEmptyObject(l))return void alert("detail record unexpectedly mising")
var c=l
$(".SMIn-house").hide(),$(".SMVoluntary").hide(),$(".SMConsultant").hide()
var d=c
if($(".SM"+d.Type).show(),n){for(o=["SMNumber","Status","InitialApprovalDate","EffectiveDate","SubjectMatter","Particulars","ProposedStartDate"],idx=0;idx<o.length;idx++)$("."+o[idx]).html(d[o[idx]])
""!==d.ProposedEndDate&&$(".ProposedEndDate").html(" to "+d.ProposedEndDate)}else $("#smRegAccordion").hide()
for(n?$("#smAccordion").show():$("#smAccordion").hide(),o=["RegistrationNUmberWithSoNum","Type","Status","EffectiveDate","PositionTitle","PreviousPublicOfficeHolder"],idx=0;idx<o.length;idx++)$("#R_"+o[idx]).html(d.Registrant[o[idx]])
$(".R_LobbyistName").html(d.Registrant.FirstName+" "+d.Registrant.MiddleInitials+" "+d.Registrant.LastName+" "+d.Registrant.Suffix),baddr=parseBusinessAddress(d.Registrant.BusinessAddress),$(".R_Address").html(baddr.Addr),$(".R_Phone").html(d.Registrant.BusinessAddress.Phone)
var u=!0
if(d.Firms){var h=convertToArrayIfNeccessary(d.Firms.Firm)
for(r=0;r<h.length;r++)if("Parent"!==h[r].Type&&"Subsidiary"!==h[r].Type&&"Other"!==h[r].Type){for(firmsFound=!0,o=["Name","TradeName","BusinessType","Description","FiscalStart"],idx=0;idx<o.length;idx++)$(".F_"+o[idx]).html(h[r][o[idx]])
""!==h[r].FiscalEnd&&$(".F_FiscalEnd").html(" to "+h[r].FiscalEnd)}}u?$("#boAccordion").show():$("#boAccordion").hide()
var m=!1,y=!1,b=[]
if(d.Beneficiaries)for(b=convertToArrayIfNeccessary(d.Beneficiaries.BENEFICIARY),r=0;r<b.length;r++)if("Client"===b[r].Type){for(baddr=parseBusinessAddress(b[r].BusinessAddress),m=!0,o=["Name","TradeName"],idx=0;idx<o.length;idx++)$(".C_"+o[idx]).html(b[r][o[idx]])
$("#C_Address").html(baddr.Addr)}else y=!0
if(m&&n?$("#clientAccordion").show():$("#clientAccordion").hide(),y){var p=0
for(r=0;r<b.length;r++)if("Client"!==b[r].Type){for(p++,baddr=parseBusinessAddress(b[r].BusinessAddress),a+="<tr class='labelRow'><td>"+p+". "+b[r].Type+"</td>",a+="<td>Other Trade Names</td>",a+="<td>Address</td>",a+="</tr>",a+="<tr><td>"+b[r].Name+"</td>",a+="<td>"+b[r].TradeName+"</td>",a+="<td>"+baddr.Addr+"</td>",a+="</tr>",o=["Name","TradeName"],idx=0;idx<o.length;idx++)$("#C_"+o[idx]).html(b[r][o[idx]])
$("#C_BusinessAddress").html(b[r].BusinessAddress.AddressLine1+"<br>"+b[r].BusinessAddress.AddressLine2),$("#C_CityProvince").html(b[r].BusinessAddress.City+", "+b[r].BusinessAddress.Province),$("#C_CountryPostal").html(b[r].BusinessAddress.Country+", "+b[r].BusinessAddress.PostalCode)}$("#OtherBeneficiariesSection tbody").html(a).trigger("update"),$("#othbAccordion").show()}else $("#othbAccordion").hide()
var g=!1
if(d.Privatefundings){var f=convertToArrayIfNeccessary(d.Privatefundings.Privatefunding)
for(a="",r=0;r<f.length;r++)g=!0,a+="<tr><td>"+(r+1)+". "+f[r].Funding+"</td>",""!==f[r].Contact&&(a+="<td><b>Contact:</b> "+f[r].Contact+"</td>"),a+="</tr>"
$("#PrivateFundingSection tbody").html(a).trigger("update")}g?$("#pfAccordion").show():$("#pfAccordion").hide()
var S=!1,L=[]
if(n||"In-house"===d.Type)for(d.Gmtfundings&&(L=convertToArrayIfNeccessary(d.Gmtfundings.Gmtfunding)),d.GMTFUNDINGS&&(L=convertToArrayIfNeccessary(d.GMTFUNDINGS.Gmtfunding)),a="",r=0;r<L.length;r++)S=!0,a+="<tr><td>"+(r+1)+". "+L[r].GMTName+", "+L[r].Program+"</td></tr>"
if(S?($("#GovernmentFundingSection tbody").html(a).trigger("update"),$("#gfAccordion").show()):$("#gfAccordion").hide(),d.Grassroots){var v=convertToArrayIfNeccessary(d.Grassroots.GRASSROOT)
for(a="",r=0;r<v.length;r++)grassRootsFound=!0,a+="<tr><td>&nbsp;</td></tr>",a+="<tr><td>"+v[r].Community+"</td>",a+="<td>"+v[r].Target+"</td>",a+="<td>"+v[r].StartDate+" to "+v[r].EndDate+"</td>",a+="</tr>"
$("#GrassRootsSection tbody").html(a).trigger("update"),$("#grAccordion").show()}else $("#grAccordion").hide()
n?detailSMMeetings(d):detailCommitees(d),detailCommunications(d),n||$("#pohAccordion").hide(),highlightOpts={separateWordSearch:!0},$("#appDisplay").jmHighlight(i,highlightOpts)}function detailSMMeetings(e){var t=0,s=0
if(e.Meetings){var i=convertToArrayIfNeccessary(e.Meetings.Meeting),a=""
for(t=0;t<i.length;t++){if(a+="<tr><td>&nbsp;</td></tr>",a+="<tr class='labelRow'><td>"+i[t].Committee+"</td></tr>",a+="<tr><td>Meeting Date "+i[t].Date+"</td></tr>",a+="<tr><td>&nbsp;</td></tr>",i[t].Lobbyists){var r=!1,o=convertToArrayIfNeccessary(i[t].Lobbyists.Lobbyist)
for(s=0;s<o.length;s++)"Committee Member"===o[s].Type&&(r||(a+="<tr class='labelRow'><td>Commitee Members in Attendance</td></tr>",r=!0),a+="<tr><td class='CommListIndent'>"+o[s].FirstName+" "+o[s].LastName+"</td></tr>")
for(a+="<tr><td>&nbsp;</td></tr>",o=convertToArrayIfNeccessary(i[t].Lobbyists.Lobbyist),r=!1,s=0;s<o.length;s++)"In-House Lobbyist"===o[s].Type&&(r||(a+="<tr class='labelRow'><td>In-house Lobbyists in Attendance</td></tr>",r=!0),a+="<tr><td class='CommListIndent'>"+o[s].FirstName+" "+o[s].LastName+" (lobbyist registration number "+o[s].Number+")</td></tr>")}if(i[t].POHS){a+="<tr><td>&nbsp;</td></tr>",a+="<tr class='labelRow'><td>Public Office Holders in Attendance</td></tr>",a+="<tr class='labelRow'><td>Type</td>",a+="<td>Name or Position Title</td>",a+="<td>Ward, Office, Division or Agency</td>",a+="</tr>"
var n=convertToArrayIfNeccessary(i[t].POHS.POH)
for(s=0;s<n.length;s++)a+="<tr><td>"+n[s].Type+"</td>",a+="<td>"+(n[s].Name?n[s].Name:n[s].Title)+"</td>",a+="<td>"+n[s].Office+"</td>",a+="</tr>"}}$("#MeetingsSection tbody").html(a).trigger("update"),$("#meetAccordion").show()}else $("#meetAccordion").hide()}function detailCommitees(e){if(e.Meetings){$("#committeeHeader").text("Committees of the Organization"),commiteeReported={}
for(var t=convertToArrayIfNeccessary(e.Meetings.Meeting),s="",i=0;i<t.length;i++)if(!commiteeReported[t[i].Committee]&&(commiteeReported[t[i].Committee]=!0,s+="<tr><td>&nbsp;</td></tr>",s+="<tr class='labelRow'><td>"+t[i].Committee+"</td></tr>",s+="<tr><td>&nbsp;</td></tr>",t[i].Lobbyists))for(var a=!1,r=convertToArrayIfNeccessary(t[i].Lobbyists.Lobbyist),o=0;o<r.length;o++)"Committee Member"===r[o].Type&&(a||(s+="<tr class='labelRow'><td>Commitee Members</td></tr>",a=!0),s+="<tr><td class='CommListIndent'>"+r[o].FirstName+" "+r[o].LastName+"</td></tr>")
$("#MeetingsSection tbody").html(s).trigger("update"),$("#meetAccordion").show()}else $("#meetAccordion").hide()}function detailCommunications(e){var t=0,s=0,i={},a="",r=[]
if(e.Communications){for(r=convertToArrayIfNeccessary(e.Communications.Communication),t=0;t<r.length;t++){var o={}
""!==r[t].LobbyistNumber&&(o.LobbyistNumber=r[t].LobbyistNumber,o.Name=r[t].LobbyistPrefix+" "+r[t].LobbyistFirstName+" "+r[t].LobbyistLastName,o.LobbyistPositionTitle=r[t].LobbyistPositionTitle,o.PreviousPublicOfficeHolder=r[t].PreviousPublicOfficeHolder,o.LobbyistType=r[t].LobbyistType,baddr=parseBusinessAddress(r[t].LobbyistBusinessAddress),o.AddrLine=baddr.Line,o.CityProv=baddr.CityProv,o.PostCty=baddr.PostCty,o.Addr=baddr.Addr,o.Phone=baddr.Phone,i[JSON.stringify(o)]||(i[JSON.stringify(o)]=!0))}Object.keys(i).sort().forEach(function(e,t,i){s++,l=JSON.parse(e),a+="<tr><td>&nbsp;</td></tr>",a+="<tr class='labelRow'><td>"+s+". In-house Lobbyist's Name</td>",a+="<td>Lobbyist Registration Number</td>",a+="<td>    Position title</td>",a+="</tr>",a+="<tr><td>"+l.Name+"</td>",a+="<td>"+l.LobbyistNumber+"</td>",a+="<td>"+l.LobbyistPositionTitle+"</td>",a+="</tr>",a+="<tr class='labelRow'><td>Business Address</td>",a+="<td>Phone</td>",a+="</tr>",a+="<tr><td>"+l.Addr+"</td>",a+="<td>"+l.Phone+"</td>",a+="</tr>",a+="<td colspan='3' class='labelRow'>Has this in-house lobbyist held a senior public office position with the City of Toronto in the past 12 months?</td>",a+="</tr>",a+="<td colspan='2'>"+l.PreviousPublicOfficeHolder+"</td>",a+="</tr>"})}if(s>0?($("#SMLSection tbody").html(a).trigger("update"),$("#smlAccordion").show()):$("#smlAccordion").hide(),s=0,a="",r=[],e.Communications)if(r=convertToArrayIfNeccessary(e.Communications.Communication),Object.keys(i).length>0)a+="<tr class='labelRow'><td>Public Office Holder Type</td><td>Name or Position Title</td><td>Ward, Office, Division or Agency</td><td>Communication Date</td><td>Communication Methods Used</td></tr>",Object.keys(i).sort().forEach(function(e,i,o){for(l=JSON.parse(e),t=0;t<r.length;t++)r[t].LobbyistNumber===l.LobbyistNumber&&""!==r[t].POH_Type&&s++
if(s>0)for(a+="<tr><td>&nbsp;</td></tr>",a+="<tr><td colspan='10'><b>"+l.Name+"</b>, "+l.LobbyistType+" (lobbyist registration number <b>"+l.LobbyistNumber+"</b>)</td>",a+="</tr>",t=0;t<r.length;t++)r[t].LobbyistNumber===l.LobbyistNumber&&""!==r[t].POH_Type&&(a+="<tr><td>"+r[t].POH_Type+"</td>",a+="<td>"+r[t].POH_Name+" "+r[t].POH_Position+"</td>",a+="<td>"+r[t].POH_Office+"</td>",a+="<td>"+r[t].CommunicationDate+"</td>",a+="<td>"+r[t].CommunicationMethod+"</td>",a+="</tr>")})
else{var n={}
for(t=0;t<r.length;t++)n[r[t].POH_Type]||(n[r[t].POH_Type]={}),n[r[t].POH_Type][r[t].POH_Name]||(n[r[t].POH_Type][r[t].POH_Name]=[]),n[r[t].POH_Type][r[t].POH_Name].push(r[t])
var c="",d=""
Object.keys(n).sort(compareCommType).forEach(function(e,t,i){c=e,Object.keys(n[e]).sort().forEach(function(e,t,i){d=e
var r=n[c][d].sort(dynamicSort("","CommunicationDate"))
a+="<tr><td>&nbsp;</td></tr>"
for(var o=0;o<r.length;o++)s++,a+="<tr><td>"+r[o].POH_Type+"</td>",a+="<td>"+r[o].POH_Name+" "+r[o].POH_Position+"</td>",a+="<td>"+r[o].POH_Office+"</td>",a+="<td>"+r[o].CommunicationDate+"</td>",a+="<td>"+r[o].CommunicationMethod+"</td>",a+="</tr>"})})}s>0?($("#CommunicationsSection tbody").html(a).trigger("update"),$("#pohAccordion").show(),$("#pohAccordion").show()):$("#pohAccordion").hide()}function loadListing(){var e=""
0===document.location.hostname.length?(e+='<link rel="stylesheet" href="css/lobbySearch.css">',e+='<link rel="stylesheet" href="js/datepicker/datepicker.css">',e+='<link rel="stylesheet" href="static_files/assets/css/bootstrap-multiselect.css">',e+='<link rel="stylesheet" href="/tablesorter/css/theme.blue.css">',e+='<script type="text/javascript" src="static_files/assets/multiselect/bootstrap-multiselect.js"></script>',e+='<script type="text/javascript" src="js/datepicker/bootstrap-datepicker.js"></script>',e+='<script type="text/javascript" src="static_files/assets/datepicker/moment-with-locales.js"></script>',e+='<script type="text/javascript" src="js/typeahead.bundle.js"></script>',e+='<script type="text/javascript" src="js/jquery.bootpag.min.js"></script>',e+='<script type="text/javascript" src="js/placeholders.jquery.js"></script>',e+='<script type="text/javascript"  src="static_files/assets/pdfmake/pdfmake.min.js"></script>',e+='<script type="text/javascript"  src="static_files/assets/pdfmake/vfs_fonts.js"></script>',$("#appCode").html(e),$("#appDisplay").load("html/lobbyListing.html",function(){initApp()})):(e+='<link rel="stylesheet" href="datepicker/datepicker.css">',e+='<link rel="stylesheet" href="/static_files/assets/multiselect/bootstrap-multiselect.css">',e+='<link rel="stylesheet" href="/tablesorter/css/theme.blue.css">',e+='<link rel="stylesheet" href="//netdna.bootstrapcdn.com/font-awesome/3.2.1/css/font-awesome.css">',e+='<link rel="stylesheet" href="/City%20Of%20Toronto/Sandbox/Steve/LobbyRegistry2/css/lobbySearch.css">',e+='<script type="text/javascript" src="/static_files/assets/multiselect/bootstrap-multiselect.js"></script>',e+='<script type="text/javascript" src="/datepicker/bootstrap-datepicker.js"></script>',e+='<script type="text/javascript" src="/static_files/assets/datepicker/moment-with-locales.js"></script>',e+='<script type="text/javascript" src="/City%20Of%20Toronto/Sandbox/Steve/LobbyRegistry2/js/typeahead.bundle.js"></script>',e+='<script type="text/javascript" src="/City%20Of%20Toronto/Sandbox/Steve/LobbyRegistry2/js/jquery.bootpag.min.js"></script>',e+='<script type="text/javascript" src="/static_files/assets/placeholders/jquery.placeholder.min.js"></script>',e+='<script type="text/javascript"  src="/static_files/assets/pdfmake/pdfmake.min.js"></script>',e+='<script type="text/javascript"  src="/static_files/assets/pdfmake/vfs_fonts.js"></script>',$("#appCode").html(e),$("#appDisplay").load("/City%20Of%20Toronto/Sandbox/Steve/LobbyRegistry2/html/lobbyListing.html",function(){initApp()}))}function loadDetail(e,t,s,i){var a=""
0===document.location.hostname.length?(a+='<link rel="stylesheet" href="css/SMDetail.css">',a+='<link rel="stylesheet" href="js/datepicker/datepicker.css">',a+='<link rel="stylesheet" href="static_files/assets/css/bootstrap-multiselect.css">',a+='<link rel="stylesheet" href="/tablesorter/css/theme.blue.css">',a+='<link rel="stylesheet" href="http://netdna.bootstrapcdn.com/font-awesome/3.2.1/css/font-awesome.css">',a+='<script type="text/javascript" src="static_files/assets/multiselect/bootstrap-multiselect.js"></script>',a+='<script type="text/javascript" src="js/datepicker/bootstrap-datepicker.js"></script>',a+='<script type="text/javascript" src="static_files/assets/datepicker/moment-with-locales.js"></script>',a+='<script type="text/javascript" src="js/typeahead.bundle.js"></script>',a+='<script type="text/javascript" src="js/jquery.bootpag.min.js"></script>',a+='<script type="text/javascript" src="js/jquery.jmHighlight.min.js"></script>',a+='<script type="text/javascript" src="js/placeholders.jquery.js"></script>',a+='<script type="text/javascript"  src="static_files/assets/pdfmake/pdfmake.min.js"></script>',a+='<script type="text/javascript"  src="static_files/assets/pdfmake/vfs_fonts.js"></script>',$("#appCode").html(a),$("#appDisplay").load("html/SMDetail.html",function(){fillDetails(e,t,s,i)})):(a+='<link rel="stylesheet" href="datepicker/datepicker.css">',a+='<link rel="stylesheet" href="/static_files/assets/multiselect/bootstrap-multiselect.css">',a+='<link rel="stylesheet" href="/tablesorter/css/theme.blue.css">',a+='<link rel="stylesheet" href="//netdna.bootstrapcdn.com/font-awesome/3.2.1/css/font-awesome.css">',a+='<link rel="stylesheet" href="/City%20Of%20Toronto/Sandbox/Steve/LobbyRegistry2/css/SMDetail.css">',a+='<script type="text/javascript" src="/static_files/assets/multiselect/bootstrap-multiselect.js"></script>',a+='<script type="text/javascript" src="/datepicker/bootstrap-datepicker.js"></script>',a+='<script type="text/javascript" src="/static_files/assets/datepicker/moment-with-locales.js"></script>',a+='<script type="text/javascript" src="/City%20Of%20Toronto/Sandbox/Steve/LobbyRegistry2/js/typeahead.bundle.js"></script>',a+='<script type="text/javascript" src="/City%20Of%20Toronto/Sandbox/Steve/LobbyRegistry2/js/jquery.bootpag.min.js"></script>',a+='<script type="text/javascript" src="/static_files/assets/placeholders/jquery.placeholder.min.js"></script>',$("#appCode").html(a),$("#appDisplay").load("/City%20Of%20Toronto/Sandbox/Steve/LobbyRegistry2/html/SMDetail.html",function(){fillDetails(e,t,s,i)}))}function getDetailData(e,t,s){$.support.cors=!0
var i=(navigator.userAgent,"/City Of Toronto/Sandbox/Steve/LobbyRegistry2/disclosure_active.json")
0===document.location.hostname.length&&(i="disclosure_active.json"),$.ajax({type:"GET",url:i,crossDomain:!0,dataType:"json",success:function(i){0===i.length?alert("detail record unexpectedly mising"):loadDetail(i,e,t,s)},error:function(e,t,s){console.log(e.status),console.log(s),alert("detail record unexpectedly mising")}})}function showSMData(e,t){getDetailData(e,null,t)}function showLRData(e,t,s){getDetailData(e,t,s)}var detailArticleGUID="aa89f7cc2dfe2510VgnVCM10000020ff0f89RCRD",detailChannelGUID="97a9f7cc2dfe2510VgnVCM10000020ff0f89RCRD",listGUID="d488c8b94c1d2510VgnVCM10000020ff0f89RCRD",detailTeaserGUID="97a9f7cc2dfe2510VgnVCM10000020ff0f89RCRD",rowsPerPage=10,nextRow=1,initialLoad=!0,jsonData,totalJSONRows=0,searchTerm,LobbyistList={},LobbyistListArray=[],BeneficiaryList={},BeneficiaryArray=[],GovFundingList={},GovFundingArray=[],BusOrgClientList={},BusOrgClientArray=[],POHNameList={},POHNameArray=[],PrivateFundingList={},PrivateFundingArray=[],currentAlpha="A",alphaMap={},selectedReport="SMRpt",filtersAreApplied=!1,CommSortOrder={"Member of Council":1,"Staff of Member of Council":2,"Member of Local Board":3,"Staff of Member of Local Board":4,"Employee of Local Board":5,"Member of Advisory Board":6,"Employee of the City":7},POHArray=[],rptColumnHdrs={SMLLobbyist:{header:"Lobbyist",size:"*"},SMLGovAgency:{header:"Gov Agency",size:"*"},SMLPrivateFunding:{header:"Fin Contributors",size:"*"},SMLFunding:{header:"Fin Contributor",size:"*"},SMLBeneficiary:{header:"Beneficiary",size:"*"},SMLLobbyistType:{header:"Lobbyist Type",size:"*"},SMLBusOrg:{header:"Bus/Org",size:"*"},SMLBusOrgClient:{header:"Bus/Org/Client",size:"*"},SMLLobbyistNames:{header:"Lobbyist Name(s)",size:100},SMLClient:{header:"Client",size:"*"},SMLPOHOfficeName:{header:"Office",size:"*"},SMLPOHName:{header:"POH",size:"*"},SMLPOHPosition:{header:"Position",size:"*"},SMLPOHPosType:{header:"Pos/Type",size:"*"},SMLSubjectMatter:{header:"Subject Matter",size:"*"},SMLStatus:{header:"Status",size:"*"},SMLInitFileDate:{header:"Init Filing Date",size:"*"},SMLSubjectMatterNo:{header:"Subject Matter No",size:"*"},SMLLobRegNo:{header:"Lobbyist Reg No.",size:"*"},SMLCommDate:{header:"Comm. Date",size:"*"}},rptColumns={BenRpt:{Idx:"A",DataSource:"BeneficiaryArray",Cols:[{column:"SMLBeneficiary","class":"",style:"width: 20%",label:"Beneficiary"},{column:"SMLBusOrg","class":"",style:"width: 20%",label:"Business/Org"},{column:"SMLLobbyistNames","class":"",style:"width: 20%",label:"Lobbyist Name(s)"},{column:"SMLLobbyistType","class":"",style:"width: 10%",label:"Lobbyist Type"},{column:"SMLPrivateFunding","class":"",style:"width: 20%",label:"Financial Contributors"},{column:"SMLSubjectMatterNo","class":"",style:"width: 10%",label:"Subject Matter No."}]},SMRpt:{Idx:"N",DataSource:"jsonData",Cols:[{column:"SMLLobbyistNames","class":"",style:"width: 25%",label:"Lobbyist Name(s)"},{column:"SMLBusOrg","class":"",style:"width: 25%",label:"Business/Org"},{column:"SMLSubjectMatter","class":"",style:"width: 24%",label:"Subject Matter"},{column:"SMLStatus","class":"",style:"width: 6%",label:"Status"},{column:"SMLInitFileDate","class":"",style:"width: 10%",label:"Initial Filing Date"},{column:"SMLSubjectMatterNo","class":"",style:"width: 10%",label:"Subject Matter No."}]},LobbyRpt:{Idx:"A",DataSource:"LobbyistListArray",Cols:[{column:"SMLLobbyist","class":"",style:"width: 15%",label:"Lobbyist Name"},{column:"SMLLobbyistType","class":"",style:"width: 9%",label:"Lobbyist Type"},{column:"SMLBusOrg","class":"",style:"width: 18%",label:"Business/Org"},{column:"SMLClient","class":"",style:"width: 18%",label:"Client"},{column:"SMLSubjectMatter","class":"",style:"width: 20%",label:"Subject Matter"},{column:"SMLLobRegNo","class":"",style:"width: 10%",label:"Lobbyist<br />Reg No."},{column:"SMLSubjectMatterNo","class":"",style:"width: 10%",label:"Subject Matter No."}]},BusOrgClientRpt:{Idx:"A",DataSource:"BusOrgArray",Cols:[{column:"SMLBusOrgClient","class":"",style:"width: 20%",label:"Business/Org/Client"},{column:"SMLLobbyistNames","class":"",style:"width: 20%",label:"Lobbyist Name(s)"},{column:"SMLLobbyistType","class":"",style:"width: 10%",label:"Lobbyist Type"},{column:"SMLBeneficiary","class":"",style:"width: 20%",label:"Beneficiary"},{column:"SMLPrivateFunding","class":"",style:"width: 20%",label:"Financial Contributors"},{column:"SMLSubjectMatterNo","class":"",style:"width: 10%",label:"Subject Matter No."}]},GovRpt:{Idx:"A",DataSource:"GovFundingArray",Cols:[{column:"SMLGovAgency","class":"col-md-3",style:"",label:"Gov. Agency"},{column:"SMLLobbyistNames","class":"col-md-2",style:"",label:"Lobbyist Name(s)"},{column:"SMLSubjectMatter","class":"col-md-2",style:"",label:"Subject Matter"},{column:"SMLStatus","class":"col-md-1",style:"",label:"Status"},{column:"SMLInitFileDate","class":"col-md-1",style:"",label:"Initial Filing Date"},{column:"SMLSubjectMatterNo","class":"col-md-1",style:"",label:"Subject Matter No."}]},FinRpt:{Idx:"A",DataSource:"PrivateFundingArray",Cols:[{column:"SMLFunding","class":"",style:"width: 20%",label:"Financial Contributor"},{column:"SMLBusOrg","class":"",style:"width: 20%",label:"Business/Org"},{column:"SMLLobbyistNames","class":"",style:"width: 20%",label:"Lobbyist Name(s)"},{column:"SMLLobbyistType","class":"",style:"width: 10%",label:"Lobbyist Type"},{column:"SMLBeneficiary","class":"",style:"width: 12%",label:"Beneficiary"},{column:"SMLStatus","class":"",style:"width: 8%",label:"Status"},{column:"SMLSubjectMatterNo","class":"",style:"width: 10%",label:"Subject Matter No."}]},POHCommRpt:{Idx:"N",DataSource:"POHArray",Cols:[{column:"SMLPOHName","class":"col-md-1",style:"",label:"POH Name"},{column:"SMLPOHPosType","class":"col-md-1",style:"",label:"POH Pos/Type"},{column:"SMLSubjectMatter","class":"col-md-2",style:"",label:"Subject Matter"},{column:"SMLLobbyist","class":"col-md-2",style:"",label:"Lobbyist"},{column:"SMLCommDate","class":"col-md-1",style:"",label:"Comm Date"},{column:"SMLMethod","class":"col-md-1",style:"",label:"Method"},{column:"SMLMeetingReq","class":"col-md-1",style:"",label:"Request a Meeting?"},{column:"SMLMeetingReqRes","class":"col-md-1",style:"",label:"Result of <br>Meeting Request?"},{column:"SMLComReqDate","class":"col-md-1",style:"",label:"Date of Request"},{column:"SMLSubjectMatterNo","class":"col-md-1",style:"",label:"Subject Matter No."}]},POHNameRpt:{Idx:"A",DataSource:"POHNameArray",Cols:[{column:"SMLPOHName","class":"",style:"width: 15%",label:"POH Name"},{column:"SMLPOHPosType","class":"",style:"width: 23%",label:"POH Pos/Type"},{column:"SMLSubjectMatter","class":"",style:"width: 22%",label:"Subject Matter"},{column:"SMLLobbyistNames","class":"",style:"width: 22%",label:"Lobbyist Name(s)"},{column:"SMLStatus","class":"",style:"width: 8%",label:"Status"},{column:"SMLSubjectMatterNo","class":"",style:"width: 10%",label:"Subject Matter No."}]}}
!function(e){e.QueryString=function(e){if(""===e)return{}
for(var t={},s=0;s<e.length;++s){var i=e[s].split("=")
2==i.length&&(t[i[0]]=decodeURIComponent(i[1].replace(/\+/g," ")))}return t}(window.location.search.substr(1).split("&"))}(jQuery),$(document).ready(function(){var e=$.QueryString.SM,t=$.QueryString.LR,s=$.QueryString.searchStr
t?showLRData(e,t,s):e?showSMData(e,s):($("#loader").show(),loadListing())})
